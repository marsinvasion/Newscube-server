<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Router - monitor</title>
    <link rel="stylesheet" href="..&#x2F;assets/css/cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="stylesheet" href="..&#x2F;assets/css/combo-min.css" id="site_styles">
    <script src="..&#x2F;assets/js/yui-min.js"></script>
    <script src="..&#x2F;assets/js/combo-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            <h1><a href="../index.html">Monitor</a> <span class="version">v0.6.1</span></h1>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/Connection.html">Connection</a></li>
            
                <li><a href="..&#x2F;classes/ConnectionTest.html">ConnectionTest</a></li>
            
                <li><a href="..&#x2F;classes/FileProbe.html">FileProbe</a></li>
            
                <li><a href="..&#x2F;classes/FileProbeTest.html">FileProbeTest</a></li>
            
                <li><a href="..&#x2F;classes/FileSyncProbe.html">FileSyncProbe</a></li>
            
                <li><a href="..&#x2F;classes/InspectProbe.html">InspectProbe</a></li>
            
                <li><a href="..&#x2F;classes/InspectTest.html">InspectTest</a></li>
            
                <li><a href="..&#x2F;classes/Log.html">Log</a></li>
            
                <li><a href="..&#x2F;classes/LogProbe.html">LogProbe</a></li>
            
                <li><a href="..&#x2F;classes/LogTest.html">LogTest</a></li>
            
                <li><a href="..&#x2F;classes/Monitor.html">Monitor</a></li>
            
                <li><a href="..&#x2F;classes/MonitorTest.html">MonitorTest</a></li>
            
                <li><a href="..&#x2F;classes/PollingProbe.html">PollingProbe</a></li>
            
                <li><a href="..&#x2F;classes/Probe.html">Probe</a></li>
            
                <li><a href="..&#x2F;classes/ProbeTest.html">ProbeTest</a></li>
            
                <li><a href="..&#x2F;classes/ProcessProbe.html">ProcessProbe</a></li>
            
                <li><a href="..&#x2F;classes/ReplProbe.html">ReplProbe</a></li>
            
                <li><a href="..&#x2F;classes/Router.html">Router</a></li>
            
                <li><a href="..&#x2F;classes/RouterTest.html">RouterTest</a></li>
            
                <li><a href="..&#x2F;classes/Server.html">Server</a></li>
            
                <li><a href="..&#x2F;classes/ServerTest.html">ServerTest</a></li>
            
                <li><a href="..&#x2F;classes/Stat.html">Stat</a></li>
            
                <li><a href="..&#x2F;classes/StatProbe.html">StatProbe</a></li>
            
                <li><a href="..&#x2F;classes/StatTest.html">StatTest</a></li>
            
                <li><a href="..&#x2F;classes/StreamProbe.html">StreamProbe</a></li>
            
                <li><a href="..&#x2F;classes/Sync.html">Sync</a></li>
            
                <li><a href="..&#x2F;classes/SyncProbe.html">SyncProbe</a></li>
            
                <li><a href="..&#x2F;classes/SyncProbeTest.html">SyncProbeTest</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/Monitor.html">Monitor</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1>Router Class</h1>
<div class="box meta">
    

    
        <div class="extends">
            Extends Backbone.Model
        </div>
    

    
        <div class="foundat">
            Defined in: <a href="..&#x2F;files&#x2F;lib_Router.js.html#l22"><code>lib&#x2F;Router.js:22</code></a>
        </div>
    

    
        
            Module: <a href="../modules/Monitor.html">Monitor</a>
        
    

    
</div>



<div class="box intro">
    <p>Probe location and message routing</p>

<p>The router is a class used internally to locate probes and connect
events so messages are correctly routed between probes and their monitors.</p>

<p>It is a <em>singleton</em> class, designed to run one instance within
a monitor process, and accessed via the (protected) <code>getRouter()</code>
method of the <a href="Monitor.html">Monitor</a> object.</p>

<p>It manages all outbound requests to probes, either internally or externally
via the <a href="Connection.html">Connection</a> to the remote process.</p>
</div>


    <div class="constructor">
        <h2>Constructor</h2>
        <div id="method_Router" class="method item">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l22" title="lib/Router.js:22">Router</a>
    </code></h3>

    
        <span class="paren">()</span>
    

    

    

    

    

    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>


        

        
    </div>

    <div class="description">
        
    </div>

    

    

    
</div>

    </div>


<div id="classdocs" class="tabview">
    <ul class="api-class-tabs">
        <li class="api-class-tab index"><a href="#index">Index</a></li>

        
            <li class="api-class-tab methods"><a href="#methods">Methods</a></li>
        
        
        
        
            <li class="api-class-tab events"><a href="#events">Events</a></li>
        
    </ul>

    <div>
        <div id="index" class="api-class-tabpanel index">
            <h2 class="off-left">Item Index</h2>

            
                <div class="index-section methods">
                    <h3>Methods</h3>

                    <ul class="index-list methods">
                        
                            <li class="index-item method protected">
                                <a href="#method_addConnection">addConnection</a>

                                
                            </li>
                        
                            <li class="index-item method protected">
                                <a href="#method_addHostConnections">addHostConnections</a>

                                
                            </li>
                        
                            <li class="index-item method protected">
                                <a href="#method_buildProbeKey">buildProbeKey</a>

                                
                            </li>
                        
                            <li class="index-item method protected">
                                <a href="#method_connectExternal">connectExternal</a>

                                
                            </li>
                        
                            <li class="index-item method protected">
                                <a href="#method_connectInternal">connectInternal</a>

                                
                            </li>
                        
                            <li class="index-item method protected">
                                <a href="#method_connectMonitor">connectMonitor</a>

                                
                            </li>
                        
                            <li class="index-item method protected">
                                <a href="#method_determineConnection">determineConnection</a>

                                
                            </li>
                        
                            <li class="index-item method protected">
                                <a href="#method_disconnectExternal">disconnectExternal</a>

                                
                            </li>
                        
                            <li class="index-item method protected">
                                <a href="#method_disconnectInternal">disconnectInternal</a>

                                
                            </li>
                        
                            <li class="index-item method protected">
                                <a href="#method_disconnectMonitor">disconnectMonitor</a>

                                
                            </li>
                        
                            <li class="index-item method protected">
                                <a href="#method_findConnection">findConnection</a>

                                
                            </li>
                        
                            <li class="index-item method protected">
                                <a href="#method_findConnections">findConnections</a>

                                
                            </li>
                        
                            <li class="index-item method protected">
                                <a href="#method_getHostName">getHostName</a>

                                
                            </li>
                        
                            <li class="index-item method protected">
                                <a href="#method_removeConnection">removeConnection</a>

                                
                            </li>
                        
                            <li class="index-item method">
                                <a href="#method_setFirewall">setFirewall</a>

                                
                                    <span class="flag static">static</span>
                                
                            </li>
                        
                            <li class="index-item method">
                                <a href="#method_setGateway">setGateway</a>

                                
                            </li>
                        
                            <li class="index-item method protected">
                                <a href="#method_setHostName">setHostName</a>

                                
                            </li>
                        
                    </ul>
                </div>
            

            

            

            
                <div class="index-section events">
                    <h3>Events</h3>

                    <ul class="index-list events">
                        
                            <li class="index-item event">
                                <a href="#event_connection:add">connection:add</a>

                                
                            </li>
                        
                            <li class="index-item event">
                                <a href="#event_connection:remove">connection:remove</a>

                                
                            </li>
                        
                    </ul>
                </div>
            
        </div>

        
            <div id="methods" class="api-class-tabpanel">
                <h2 class="off-left">Methods</h2>

                
                    <div id="method_addConnection" class="method item protected">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l153" title="lib/Router.js:153">addConnection</a>
    </code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>options</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    
        <span class="returns-inline">
            <span class="type"><a href="../classes/Connection.html" class="crosslink">Connection</a></span>
        </span>
    

    

    
        <span class="flag protected">protected</span>
    

    

    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>


        

        
    </div>

    <div class="description">
        <p>Add a connection to a remote Monitor process</p>
    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">options</code>
                        <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object" class="crosslink external" target="_blank">Object</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>Connection parameters</li>
</ul>
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">hostName</code>
                                    <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>
                                

                                <div class="param-description">
                                    <ul>
<li>Name of the host to connect with</li>
</ul>
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">hostPort</code>
                                    <span class="type">Integer</span>
                                

                                <div class="param-description">
                                    <ul>
<li>Port number to connect with</li>
</ul>
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">url</code>
                                    <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>
                                

                                <div class="param-description">
                                    <ul>
<li>The URL used to connect (created, or used if supplied)</li>
</ul>
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">socket</code>
                                    <span class="type">Io.socket</span>
                                

                                <div class="param-description">
                                    <ul>
<li>Pre-connected socket.io socket to a Monitor server.</li>
</ul>
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">gateway</code>
                                    <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Boolean" class="crosslink external" target="_blank">Boolean</a></span>
                                

                                <div class="param-description">
                                    <ul>
<li>Allow this connection to use me as a gateway (default false)</li>
</ul>
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">firewall</code>
                                    <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Boolean" class="crosslink external" target="_blank">Boolean</a></span>
                                

                                <div class="param-description">
                                    <p>Firewall inbound probe requests on this connection?</p>
                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
            </ul>
        </div>
    

    
        <div class="returns">
            <h4>Returns:</h4>

            <div class="returns-description">
                
                    
                        <span class="type"><a href="../classes/Connection.html" class="crosslink">Connection</a></span>:
                    
                    connection  - The added connection
                
            </div>
        </div>
    

    
</div>

                
                    <div id="method_addHostConnections" class="method item protected">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l561" title="lib/Router.js:561">addHostConnections</a>
    </code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>hostName</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    
        <span class="flag protected">protected</span>
    

    

    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>


        

        
    </div>

    <div class="description">
        <p>Add connections for the specified host</p>

<p>This performs a scan of monitor ports on the server, and adds connections
for newly discovered servers.</p>

<p>It can take a while to complete, and if called for the same host before
completion, it will save the callback and call all callbacks when the
original task is complete.</p>
    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">hostName</code>
                        <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>The host to add connections with</li>
</ul>
                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function(error)</span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>Called when complete</li>
</ul>
                    </div>

                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method_buildProbeKey" class="method item protected">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l333" title="lib/Router.js:333">buildProbeKey</a>
    </code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>probeJSON</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    
        <span class="returns-inline">
            <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>
        </span>
    

    

    
        <span class="flag protected">protected</span>
    

    

    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>


        

        
    </div>

    <div class="description">
        <p>Build a probe key from the probe data</p>
    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">probeJSON</code>
                        <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object" class="crosslink external" target="_blank">Object</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>An object containing:</li>
</ul>
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">probeClass</code>
                                    <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>
                                

                                <div class="param-description">
                                    <ul>
<li>The probe class name (required)</li>
</ul>
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">initParams</code>
                                    <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object" class="crosslink external" target="_blank">Object</a></span>
                                

                                <div class="param-description">
                                    <ul>
<li>Probe initialization parameters (if any)</li>
</ul>
                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
            </ul>
        </div>
    

    
        <div class="returns">
            <h4>Returns:</h4>

            <div class="returns-description">
                
                    
                        <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>:
                    
                    probeKey  - A string identifying the probe
                
            </div>
        </div>
    

    
</div>

                
                    <div id="method_connectExternal" class="method item protected">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l750" title="lib/Router.js:750">connectExternal</a>
    </code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>monitorJSON</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>connection</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    
        <span class="flag protected">protected</span>
    

    

    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>


        

        
    </div>

    <div class="description">
        <p>Connect to an external probe implementation.</p>

<p>This connects with a probe running in another process.  It will
coordinate the remote instantiation of the probe if it's not running.</p>
    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">monitorJSON</code>
                        <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object" class="crosslink external" target="_blank">Object</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>An object containing:</li>
</ul>
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">probeClass</code>
                                    <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>
                                

                                <div class="param-description">
                                    <ul>
<li>The probe class name (required)</li>
</ul>
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">initParams</code>
                                    <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object" class="crosslink external" target="_blank">Object</a></span>
                                

                                <div class="param-description">
                                    <ul>
<li>Probe initialization parameters (if any)</li>
</ul>
                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">connection</code>
                        <span class="type"><a href="../classes/Connection.html" class="crosslink">Connection</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>The connection to use</li>
</ul>
                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function(error, probeProxy)</span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>Called when connected</li>
</ul>
                    </div>

                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method_connectInternal" class="method item protected">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l632" title="lib/Router.js:632">connectInternal</a>
    </code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>monitorJSON</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    
        <span class="flag protected">protected</span>
    

    

    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>


        

        
    </div>

    <div class="description">
        <p>Connect to an internal probe implementation</p>

<p>This connects with a probe running in this process.  It will instantiate
the probe if it isn't currently running.</p>
    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">monitorJSON</code>
                        <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object" class="crosslink external" target="_blank">Object</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>The monitor toJSON data.  Containing:</li>
</ul>
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">probeClass</code>
                                    <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>
                                

                                <div class="param-description">
                                    <ul>
<li>The probe class name to connect with (required)</li>
</ul>
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">initParams</code>
                                    <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object" class="crosslink external" target="_blank">Object</a></span>
                                

                                <div class="param-description">
                                    <ul>
<li>Probe initialization parameters.</li>
</ul>
                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function(error, probeImpl)</span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>Called when connected</li>
</ul>
                    </div>

                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method_connectMonitor" class="method item protected">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l224" title="lib/Router.js:224">connectMonitor</a>
    </code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>monitor</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    
        <span class="flag protected">protected</span>
    

    

    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>


        

        
    </div>

    <div class="description">
        <p>Connect a Monitor object to a remote Probe</p>

<p>This accepts an instance of a Monitor and figures out how to connect it
to a running Probe.</p>

<p>Upon callback the probe data is set into the monitor (unless an error
occurred)</p>
    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">monitor</code>
                        <span class="type"><a href="../classes/Monitor.html" class="crosslink">Monitor</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>The monitor requesting to connect with the probe</li>
</ul>
                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function(error)</span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>(optional) Called when connected</li>
</ul>
                    </div>

                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method_determineConnection" class="method item protected">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l353" title="lib/Router.js:353">determineConnection</a>
    </code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>monitorJSON</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>makeNewConnections</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    
        <span class="flag protected">protected</span>
    

    

    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>


        

        
    </div>

    <div class="description">
        <p>Determine the connection to use for a probe</p>

<p>This uses the connection parameters of the specified monitor to determine
(or create) the connection to use for the probe.</p>

<p>If the probe can be instantiated internally, a null is returned as the
connection.</p>

<p>This attempts to use an existing connection if available.  If not, a
connection attempt will be made with the host. If the host cannot be
reached directly, it returns a connection with the gateway.</p>
    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">monitorJSON</code>
                        <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object" class="crosslink external" target="_blank">Object</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>The connection attributes of the monitor</li>
</ul>
                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">makeNewConnections</code>
                        <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Boolean" class="crosslink external" target="_blank">Boolean</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>Establish a new connection if one doesn't exist?</li>
</ul>
                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function(error, connection)</span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>Called when the connection is known
<ul>
<li>error - Set if any errors</li>
<li>connection - The connection object, or null to run in this process</li>
<ul></li>
</ul>
                    </div>

                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method_disconnectExternal" class="method item protected">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l814" title="lib/Router.js:814">disconnectExternal</a>
    </code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>connection</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>probeId</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    
        <span class="flag protected">protected</span>
    

    

    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>


        

        
    </div>

    <div class="description">
        <p>Disconnect with an external probe implementation.</p>
    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">connection</code>
                        <span class="type"><a href="../classes/Connection.html" class="crosslink">Connection</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>The connection to use</li>
</ul>
                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">probeId</code>
                        <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>Probe ID</li>
</ul>
                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function(error)</span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>Called when disconnected</li>
</ul>
                    </div>

                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method_disconnectInternal" class="method item protected">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l723" title="lib/Router.js:723">disconnectInternal</a>
    </code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>probeId</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    
        <span class="flag protected">protected</span>
    

    

    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>


        

        
    </div>

    <div class="description">
        <p>Disconnect with an internal probe implementation.</p>
    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">probeId</code>
                        <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>The probe implementation ID to disconnect</li>
</ul>
                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function(error, probeImpl)</span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>Called when disconnected</li>
</ul>
                    </div>

                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method_disconnectMonitor" class="method item protected">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l292" title="lib/Router.js:292">disconnectMonitor</a>
    </code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>monitor</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>reason</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>callback</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    
        <span class="flag protected">protected</span>
    

    

    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>


        

        
    </div>

    <div class="description">
        <p>Disconnect a monitor</p>

<p>This accepts an instance of a connected monitor, and disconnects it from
the remote probe.</p>

<p>The probe implementation will be released if this is the only monitor
object watching it.</p>
    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">monitor</code>
                        <span class="type"><a href="../classes/Monitor.html" class="crosslink">Monitor</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>The connected monitor</li>
</ul>
                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">reason</code>
                        <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>Reason for the disconnect</li>
</ul>
                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">callback</code>
                        <span class="type">Function(error)</span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>(optional) Called when connected</li>
</ul>
                    </div>

                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method_findConnection" class="method item protected">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l503" title="lib/Router.js:503">findConnection</a>
    </code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>hostName</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>appName</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>appInstance</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    
        <span class="returns-inline">
            <span class="type"><a href="../classes/Connection.html" class="crosslink">Connection</a></span>
        </span>
    

    

    
        <span class="flag protected">protected</span>
    

    

    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>


        

        
    </div>

    <div class="description">
        <p>Find an existing connection to use</p>

<p>This method looks into the existing known connections to find one
that matches the specified parameters.</p>

<p>Firewalled connections are not returned.</p>
    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">hostName</code>
                        <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>Host name to find a connection for (null = any host)</li>
</ul>
                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">appName</code>
                        <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>App name to find a connection with (null = any app)</li>
</ul>
                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">appInstance</code>
                        <span class="type">Any</span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>Application instance running on this host (null = any instance)</li>
</ul>
                    </div>

                    
                </li>
            
            </ul>
        </div>
    

    
        <div class="returns">
            <h4>Returns:</h4>

            <div class="returns-description">
                
                    
                        <span class="type"><a href="../classes/Connection.html" class="crosslink">Connection</a></span>:
                    
                    connection  - A Connection object if found, otherwise null
                
            </div>
        </div>
    

    
</div>

                
                    <div id="method_findConnections" class="method item protected">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l533" title="lib/Router.js:533">findConnections</a>
    </code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>hostName</code>
                    
                </li>
            
                <li class="arg">
                    
                        <code>appName</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    
        <span class="returns-inline">
            <span class="type">Array of Connection</span>
        </span>
    

    

    
        <span class="flag protected">protected</span>
    

    

    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>


        

        
    </div>

    <div class="description">
        <p>Find all connections matching the selection criteria</p>

<p>This method looks into the existing known connections to find all
that match the specified parameters.</p>

<p>Firewalled connections are not returned.</p>
    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">hostName</code>
                        <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>Host name to search for (null = any host)</li>
</ul>
                    </div>

                    
                </li>
            
                <li class="param">
                    
                        <code class="param-name">appName</code>
                        <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>App name to search for (null = any app)</li>
</ul>
                    </div>

                    
                </li>
            
            </ul>
        </div>
    

    
        <div class="returns">
            <h4>Returns:</h4>

            <div class="returns-description">
                
                    
                        <span class="type">Array of Connection</span>:
                    
                    connections  - An array of Connection objects matching the criteria
                
            </div>
        </div>
    

    
</div>

                
                    <div id="method_getHostName" class="method item protected">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l121" title="lib/Router.js:121">getHostName</a>
    </code></h3>

    
        <span class="paren">()</span>
    

    
        <span class="returns-inline">
            <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>
        </span>
    

    

    
        <span class="flag protected">protected</span>
    

    

    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>


        

        
    </div>

    <div class="description">
        <p>Return a stable host name.</p>
    </div>

    

    
        <div class="returns">
            <h4>Returns:</h4>

            <div class="returns-description">
                
                    
                        <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>:
                    
                    hostName  - The platform's host name, or an otherwise stable ID
                
            </div>
        </div>
    

    
</div>

                
                    <div id="method_removeConnection" class="method item protected">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l207" title="lib/Router.js:207">removeConnection</a>
    </code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>connection</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    
        <span class="flag protected">protected</span>
    

    

    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>


        

        
    </div>

    <div class="description">
        <p>Remove a connection from the router.</p>

<p>This is called to remove the connection and associated routes from the router.</p>
    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">connection</code>
                        <span class="type"><a href="../classes/Connection.html" class="crosslink">Connection</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>The connection to remove</li>
</ul>
                    </div>

                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method_setFirewall" class="method item">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l66" title="lib/Router.js:66">setFirewall</a>
    </code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>firewall</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    

    

    
        <span class="flag static">static</span>
    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>


        

        
    </div>

    <div class="description">
        <p>Firewall new connections from inbound probe requests</p>

<p>When two monitor processes connect, they become peers.  By default each
process can request probe connections with the other.</p>

<p>If you want to connect with a remote probe, but don't want those servers
to connect with probes in this process, call this method to firewall
those inbound probe requests.</p>

<p>Setting this will change the firewall value for all <em>new</em> connections.
Any existing connections will still accept incoming probe requests.</p>
    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">firewall</code>
                        <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Boolean" class="crosslink external" target="_blank">Boolean</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>Firewall new connections?</li>
</ul>
                    </div>

                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
                    <div id="method_setGateway" class="method item">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l89" title="lib/Router.js:89">setGateway</a>
    </code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>options</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    
        <span class="returns-inline">
            <span class="type"><a href="../classes/Connection.html" class="crosslink">Connection</a></span>
        </span>
    

    

    

    

    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>


        

        
    </div>

    <div class="description">
        <p>Set the default gateway server</p>

<p>The gateway server is used if a monitor cannot connect directly with the
server hosting the probe.</p>

<p>When a monitor is requested to connect with a probe on a specific server,
a direct connection is attempted.  If that direct connection fails, usually
due to a firewall or browser restriction, the monitor will attempt the
connection to the probe through the gateway server.</p>

<p>The server specified in this method must have been started as a gateway
like this:</p>

<pre class="code"><code class="prettyprint">// Start a monitor server and act as a gateway
var server = new Monitor.Server({gateway:true});
</code></pre>
    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">options</code>
                        <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object" class="crosslink external" target="_blank">Object</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>Connection parameters</li>
</ul>
                    </div>

                    
                        <ul class="params-list">
                            
                            <li class="param">
                                
                                    <code class="param-name">hostName</code>
                                    <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>
                                

                                <div class="param-description">
                                    <ul>
<li>Name of the gateway host</li>
</ul>
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">hostPort</code>
                                    <span class="type">Integer</span>
                                

                                <div class="param-description">
                                    <ul>
<li>Port number to connect with</li>
</ul>
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">url</code>
                                    <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>
                                

                                <div class="param-description">
                                    <ul>
<li>The URL used to connect (created, or used if supplied)</li>
</ul>
                                </div>

                                
                            </li>
                            
                            <li class="param">
                                
                                    <code class="param-name">socket</code>
                                    <span class="type">Io.socket</span>
                                

                                <div class="param-description">
                                    <ul>
<li>Pre-connected socket.io socket to the gateway server.</li>
</ul>
                                </div>

                                
                            </li>
                            
                        </ul>
                    
                </li>
            
            </ul>
        </div>
    

    
        <div class="returns">
            <h4>Returns:</h4>

            <div class="returns-description">
                
                    
                        <span class="type"><a href="../classes/Connection.html" class="crosslink">Connection</a></span>:
                    
                    connection  - The connection with the gateway server
                
            </div>
        </div>
    

    
</div>

                
                    <div id="method_setHostName" class="method item protected">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l138" title="lib/Router.js:138">setHostName</a>
    </code></h3>

    
        <div class="args">
            <span class="paren">(</span><ul class="args-list inline commas">
            
                <li class="arg">
                    
                        <code>hostName</code>
                    
                </li>
            
            </ul><span class="paren">)</span>
        </div>
    

    

    

    
        <span class="flag protected">protected</span>
    

    

    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>


        

        
    </div>

    <div class="description">
        <p>Set the current host name.</p>

<p>This sets the host name that this router publishes to new connections.
It's only useful if the os hostname isn't the name you want to publish.</p>
    </div>

    
        <div class="params">
            <h4>Parameters:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">hostName</code>
                        <span class="type"><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></span>
                    

                    

                    <div class="param-description">
                        <ul>
<li>The host name to publish to new connections</li>
</ul>
                    </div>

                    
                </li>
            
            </ul>
        </div>
    

    

    
</div>

                
            </div>
        

        

        

        
            <div id="events" class="api-class-tabpanel">
                <h2 class="off-left">Events</h2>

                
                    <div id="event_connection:add" class="events item">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l39" title="lib/Router.js:39">connection:add</a>
    </code></h3>
    <span class="type"></span>

    

    

    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>

        

        
    </div>

    <div class="description">
        <p>A new connection has been established</p>
    </div>

    
        <div class="params">
            <h4>Event Payload:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">connection</code>
                        <span class="type"><a href="../classes/Connection.html" class="crosslink">Connection</a></span>
                    

                    

                    <div class="param-description">
                        <p>The added connection</p>
                    </div>

                    
                </li>
            
            </ul>
        </div>
    


    
</div>

                
                    <div id="event_connection:remove" class="events item">
    <h3 class="name"><code>
      <a href="..&#x2F;files&#x2F;lib_Router.js.html#l46" title="lib/Router.js:46">connection:remove</a>
    </code></h3>
    <span class="type"></span>

    

    

    

    

    <div class="meta">
        
            
                
                <p>
            
        
        </p>

        

        
    </div>

    <div class="description">
        <p>A connection has been terminated</p>
    </div>

    
        <div class="params">
            <h4>Event Payload:</h4>

            <ul class="params-list">
            
                <li class="param">
                    
                        <code class="param-name">connection</code>
                        <span class="type"><a href="../classes/Connection.html" class="crosslink">Connection</a></span>
                    

                    

                    <div class="param-description">
                        <p>The removed connection</p>
                    </div>

                    
                </li>
            
            </ul>
        </div>
    


    
</div>

                
            </div>
        
    </div>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="ft">
        <div class="footer-left">
          Copyright &copy; 2010-2013 <a href="https://github.com/lorenwest/node-monitor">Loren West, and other contributors</a>. All rights reserved.
        </div>
        <div class="footer-right">
          Docs generated using <a href="https://github.com/yui/yuidoc">YUIDoc JS</a>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
